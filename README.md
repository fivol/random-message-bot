# Random message bot

Телеграм бот для общения со случайными незнакомцами, создания своих или просмотра чужих публикаций.
> [@random_message_bot](https://t.me/random_message_bot)


## Команды
- `/start` зарегистрироваться и показать приветственное сообщение (`/help` делает то же
  самое для существующих пользователей)
- `/help` справка по работе бота и список существующих команд
- `/get` получения случайного сообщения
- Добавь к тексту `/support`, чтобы написать в поддержку

## Функционал
1. Отправить сообщение с каким-либо контентом (voice, photo, video_note),
оно будет добавлено в единую базу, откуда присылается другим людям
2. Можно переслать полученное сообщение обратно боту (свайп влево) со своим комментарием 
   (необязательно текстовым), чтобы ответить его автору
   - Это может быть просто реакция на контент: критика, замечание, комментарий, вопрос, уточнение и тд
   - Анонимный диалог, так как на ответ можно также отвечать, кроме как прислать в тексте контакты
    нет возможности понять, кто на обратном конце
   - Анонимное послание или обращение
3. В ответ на каждое полученное от бота сообщение, можно отреагировать с 
   помощью одной из четырех кнопок
   - Спам. Отметит его как нежелательное и сильно уменьшит вероятность показа другим
   - Дизлайк, лайк. Информирует систему о личных предпочтениях. Изменяет шанс показа аудитории
    
    

![](https://files.catbox.moe/ropsr2.png)
    
## Примеры использования
1. Задать вопрос и получить ответы
1. Рассказать в аудио или видео сообщении интересную историю
1. Поделиться уникальным авторским контентом


## Логика
1. При выдаче результата учитывается
    - Количество положительных / отрицательных оценок
    - Количество жалоб на спам
    - Время публикации. Старые все реже показываются
2. Бот может запросить ваши публикации для того, чтобы продолжить 
   просмотр других с целью мотивации создания контента, для просмотра
   вам доступно количество, пропорциональное квадрату отправленных
   
## Deploy
1. Скрипт `/push` загружает ветку мастер на [heroku](https://heroku.com) (нужен активный CLI)
1. Для локального тестирования необходимо В корне создать файл `.env` со следующими переменными
   - Режим `DEBUG` нужен для более подробного логирования
   - `ALARMER_KEY` секретный ключ телеграм бота [@alarmer_bot](https://t.me/alarmer_bot) 
     для получения уведомлений об ошибках
   - `BOT_API_TOKEN` Telegram bot api token  
   - `PG_URL` URL для подключения к базе данных Postgres
   - `HOST` url хоста, на котором будет запущен бот, для установления веб хуков, если DEBUG=True, используется
   `pooling` вместо `set_webhook`
```dotenv
DEBUG=
ALARMER_KEY=
BOT_API_TOKEN=
PG_URL=
HOST=
```
3. Для развертки бота следует указать те же самые переменные окружения, за исключением `DEBUG=False`
3. `Procfile` содержит указания для heroku по запуску

## Создание
1. Телеграм бот написан в 2019 году
1. В основе использована библиотека pyTelegramBotAPI
